<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.Monad.Trans.Resource</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-Monad-Trans-Resource.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">resourcet-1.1.7.4: Deterministic allocation and freeing of scarce resources.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Control.Monad.Trans.Resource</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Data types</a></li><li><a href="#g:2">Unwrap</a></li><li><a href="#g:3">Special actions</a></li><li><a href="#g:4">Monad transformation</a></li><li><a href="#g:5">Registering/releasing</a></li><li><a href="#g:6">Type class/associated types</a><ul><li><a href="#g:7">Low-level</a></li></ul></li><li><a href="#g:8">Re-exports</a></li><li><a href="#g:9">Internal state</a></li><li><a href="#g:10">Backwards compatibility</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Allocate resources which are guaranteed to be released.</p><p>For more information, see <a href="https://www.fpcomplete.com/user/snoyberg/library-documentation/resourcet">https://www.fpcomplete.com/user/snoyberg/library-documentation/resourcet</a>.</p><p>One point to note: all register cleanup actions live in the <code>IO</code> monad, not
 the main monad. This allows both more efficient code, and for monads to be
 transformed.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:ResourceT">ResourceT</a> m a</li><li class="src short"><span class="keyword">type</span> <a href="#t:ResIO">ResIO</a> a = <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:ReleaseKey">ReleaseKey</a></li><li class="src short"><a href="#v:runResourceT">runResourceT</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a -&gt; m a</li><li class="src short"><a href="#v:resourceForkIO">resourceForkIO</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m () -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m <a href="../base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></li><li class="src short"><a href="#v:transResourceT">transResourceT</a> :: (m a -&gt; n b) -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> n b</li><li class="src short"><a href="#v:joinResourceT">joinResourceT</a> :: <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m) a -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a</li><li class="src short"><a href="#v:allocate">allocate</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a -&gt; (a -&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> ()) -&gt; m (<a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a>, a)</li><li class="src short"><a href="#v:register">register</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> () -&gt; m <a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a></li><li class="src short"><a href="#v:release">release</a> :: <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a> -&gt; m ()</li><li class="src short"><a href="#v:unprotect">unprotect</a> :: <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a> -&gt; m (<a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> ()))</li><li class="src short"><a href="#v:resourceMask">resourceMask</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; ((<span class="keyword">forall</span> a. <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a) -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> b) -&gt; m b</li><li class="src short"><span class="keyword">class</span> (<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m, <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m) =&gt; <a href="#t:MonadResource">MonadResource</a> m <span class="keyword">where</span><ul class="subs"><li><a href="#v:liftResourceT">liftResourceT</a> :: <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a -&gt; m a</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:MonadResourceBase">MonadResourceBase</a> m = (<a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m, <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m, <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m)</li><li class="src short"><span class="keyword">data</span> <a href="#t:InvalidAccess">InvalidAccess</a> = <a href="#v:InvalidAccess">InvalidAccess</a> {<ul class="subs"><li><a href="#v:functionName">functionName</a> :: <a href="../base-4.8.2.0/Data-String.html#t:String">String</a></li></ul>}</li><li class="src short"><span class="keyword">class</span> <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> b m =&gt; <a href="#t:MonadBaseControl">MonadBaseControl</a> b m | m -&gt; b</li><li class="src short"><span class="keyword">type</span> <a href="#t:InternalState">InternalState</a> = <a href="../base-4.8.2.0/Data-IORef.html#t:IORef">IORef</a> <a href="Control-Monad-Trans-Resource-Internal.html#t:ReleaseMap">ReleaseMap</a></li><li class="src short"><a href="#v:getInternalState">getInternalState</a> :: <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a></li><li class="src short"><a href="#v:runInternalState">runInternalState</a> :: <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a -&gt; <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a> -&gt; m a</li><li class="src short"><a href="#v:withInternalState">withInternalState</a> :: (<a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a> -&gt; m a) -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a</li><li class="src short"><a href="#v:createInternalState">createInternalState</a> :: <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; m <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a></li><li class="src short"><a href="#v:closeInternalState">closeInternalState</a> :: <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a> -&gt; m ()</li><li class="src short"><span class="keyword">type</span> <a href="#t:ExceptionT">ExceptionT</a> = <a href="../exceptions-0.8.2.1/Control-Monad-Catch-Pure.html#t:CatchT">CatchT</a></li><li class="src short"><a href="#v:runExceptionT">runExceptionT</a> :: <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> m a -&gt; m (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Control-Exception-Base.html#t:SomeException">SomeException</a> a)</li><li class="src short"><a href="#v:runExceptionT_">runExceptionT_</a> :: <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> m a -&gt; m a</li><li class="src short"><a href="#v:runException">runException</a> :: <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> <a href="../base-4.8.2.0/Data-Functor-Identity.html#t:Identity">Identity</a> a -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Control-Exception-Base.html#t:SomeException">SomeException</a> a</li><li class="src short"><a href="#v:runException_">runException_</a> :: <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> <a href="../base-4.8.2.0/Data-Functor-Identity.html#t:Identity">Identity</a> a -&gt; a</li><li class="src short"><span class="keyword">class</span> <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="#t:MonadThrow">MonadThrow</a> m <span class="keyword">where</span><ul class="subs"><li><a href="#v:throwM">throwM</a> :: <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; e -&gt; m a</li></ul></li><li class="src short"><a href="#v:monadThrow">monadThrow</a> :: (<a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e, <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m) =&gt; e -&gt; m a</li></ul></div><div id="interface"><h1 id="g:1">Data types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ResourceT" class="def">ResourceT</a> m a</p><div class="doc"><p>The Resource transformer. This transformer keeps track of all registered
 actions, and calls them upon exit (via <code>runResourceT</code>). Actions may be
 registered via <code>register</code>, or resources may be allocated atomically via
 <code>allocate</code>. <code>allocate</code> corresponds closely to <code>bracket</code>.</p><p>Releasing may be performed before exit via the <code>release</code> function. This is a
 highly recommended optimization, as it will ensure that scarce resources are
 freed early. Note that calling <code>release</code> will deregister the action, so that
 a release action will only ever be called once.</p><p>Since 0.3.0</p></div><div class="subs instances"><p id="control.i:ResourceT" class="caption collapser" onclick="toggleSection('i:ResourceT')">Instances</p><div id="section.i:ResourceT" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../mmorph-1.0.6/Control-Monad-Morph.html#t:MFunctor">MFunctor</a> <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a></span></td><td class="doc"><p>Since 0.4.7</p></td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mmorph-1.0.6/Control-Monad-Morph.html#t:MMonad">MMonad</a> <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a></span></td><td class="doc"><p>Since 0.4.7</p></td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mmorph-1.0.6/Control-Monad-Morph.html#t:MonadTrans">MonadTrans</a> <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../monad-control-1.0.1.0/Control-Monad-Trans-Control.html#t:MonadTransControl">MonadTransControl</a> <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mtl-2.2.1/Control-Monad-RWS-Class.html#t:MonadRWS">MonadRWS</a> r w s m =&gt; <a href="../mtl-2.2.1/Control-Monad-RWS-Class.html#t:MonadRWS">MonadRWS</a> r w s (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> b m =&gt; <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> b (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> e m =&gt; <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> e (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mtl-2.2.1/Control-Monad-Reader-Class.html#t:MonadReader">MonadReader</a> r m =&gt; <a href="../mtl-2.2.1/Control-Monad-Reader-Class.html#t:MonadReader">MonadReader</a> r (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mtl-2.2.1/Control-Monad-State-Class.html#t:MonadState">MonadState</a> s m =&gt; <a href="../mtl-2.2.1/Control-Monad-State-Class.html#t:MonadState">MonadState</a> s (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mtl-2.2.1/Control-Monad-Writer-Class.html#t:MonadWriter">MonadWriter</a> w m =&gt; <a href="../mtl-2.2.1/Control-Monad-Writer-Class.html#t:MonadWriter">MonadWriter</a> w (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Functor.html#t:Functor">Functor</a> m =&gt; <a href="../base-4.8.2.0/Data-Functor.html#t:Functor">Functor</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m =&gt; <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Control-Applicative.html#t:Alternative">Alternative</a> m =&gt; <a href="../base-4.8.2.0/Control-Applicative.html#t:Alternative">Alternative</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc"><p>Since 1.1.5</p></td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Control-Monad.html#t:MonadPlus">MonadPlus</a> m =&gt; <a href="../base-4.8.2.0/Control-Monad.html#t:MonadPlus">MonadPlus</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc"><p>Since 1.1.5</p></td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../exceptions-0.8.2.1/Control-Monad-Catch.html#t:MonadCatch">MonadCatch</a> m =&gt; <a href="../exceptions-0.8.2.1/Control-Monad-Catch.html#t:MonadCatch">MonadCatch</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../exceptions-0.8.2.1/Control-Monad-Catch.html#t:MonadMask">MonadMask</a> m =&gt; <a href="../exceptions-0.8.2.1/Control-Monad-Catch.html#t:MonadMask">MonadMask</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../mtl-2.2.1/Control-Monad-Cont-Class.html#t:MonadCont">MonadCont</a> m =&gt; <a href="../mtl-2.2.1/Control-Monad-Cont-Class.html#t:MonadCont">MonadCont</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m, <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="../monad-control-1.0.1.0/Control-Monad-Trans-Control.html#t:StT">StT</a> <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> a = a</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="../monad-control-1.0.1.0/Control-Monad-Trans-Control.html#t:StM">StM</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m) a = <a href="../monad-control-1.0.1.0/Control-Monad-Trans-Control.html#t:StM">StM</a> m a</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ResIO" class="def">ResIO</a> a = <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a</p><div class="doc"><p>Convenient alias for <code>ResourceT IO</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ReleaseKey" class="def">ReleaseKey</a></p><div class="doc"><p>A lookup key for a specific release action. This value is returned by
 <code>register</code> and <code>allocate</code>, and is passed to <code>release</code>.</p><p>Since 0.3.0</p></div></div><h1 id="g:2">Unwrap</h1><div class="top"><p class="src"><a name="v:runResourceT" class="def">runResourceT</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a -&gt; m a</p><div class="doc"><p>Unwrap a <code><a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a></code> transformer, and call all registered release actions.</p><p>Note that there is some reference counting involved due to <code><a href="Control-Monad-Trans-Resource.html#v:resourceForkIO">resourceForkIO</a></code>.
 If multiple threads are sharing the same collection of resources, only the
 last call to <code>runResourceT</code> will deallocate the resources.</p><p>Since 0.3.0</p></div></div><h1 id="g:3">Special actions</h1><div class="top"><p class="src"><a name="v:resourceForkIO" class="def">resourceForkIO</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m () -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m <a href="../base-4.8.2.0/Control-Concurrent.html#t:ThreadId">ThreadId</a></p><div class="doc"><p>Introduce a reference-counting scheme to allow a resource context to be
 shared by multiple threads. Once the last thread exits, all remaining
 resources will be released.</p><p>Note that abuse of this function will greatly delay the deallocation of
 registered resources. This function should be used with care. A general
 guideline:</p><p>If you are allocating a resource that should be shared by multiple threads,
 and will be held for a long time, you should allocate it at the beginning of
 a new <code>ResourceT</code> block and then call <code>resourceForkIO</code> from there.</p><p>Since 0.3.0</p></div></div><h1 id="g:4">Monad transformation</h1><div class="top"><p class="src"><a name="v:transResourceT" class="def">transResourceT</a> :: (m a -&gt; n b) -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> n b</p><div class="doc"><p>Transform the monad a <code>ResourceT</code> lives in. This is most often used to
 strip or add new transformers to a stack, e.g. to run a <code>ReaderT</code>.</p><p>Note that this function is a slight generalization of <code><a href="../mmorph-1.0.6/Control-Monad-Morph.html#v:hoist">hoist</a></code>.</p><p>Since 0.3.0</p></div></div><div class="top"><p class="src"><a name="v:joinResourceT" class="def">joinResourceT</a> :: <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m) a -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a</p><div class="doc"><p>This function mirrors <code>join</code> at the transformer level: it will collapse
 two levels of <code>ResourceT</code> into a single <code>ResourceT</code>.</p><p>Since 0.4.6</p></div></div><h1 id="g:5">Registering/releasing</h1><div class="top"><p class="src"><a name="v:allocate" class="def">allocate</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a</td><td class="doc"><p>allocate</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> ())</td><td class="doc"><p>free resource</p></td></tr><tr><td class="src">-&gt; m (<a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a>, a)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Perform some allocation, and automatically register a cleanup action.</p><p>This is almost identical to calling the allocation and then
 <code>register</code>ing the release action, but this properly handles masking of
 asynchronous exceptions.</p><p>Since 0.3.0</p></div></div><div class="top"><p class="src"><a name="v:register" class="def">register</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> () -&gt; m <a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a></p><div class="doc"><p>Register some action that will be called precisely once, either when
 <code><a href="Control-Monad-Trans-Resource.html#v:runResourceT">runResourceT</a></code> is called, or when the <code><a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a></code> is passed to <code><a href="Control-Monad-Trans-Resource.html#v:release">release</a></code>.</p><p>Since 0.3.0</p></div></div><div class="top"><p class="src"><a name="v:release" class="def">release</a> :: <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a> -&gt; m ()</p><div class="doc"><p>Call a release action early, and deregister it from the list of cleanup
 actions to be performed.</p><p>Since 0.3.0</p></div></div><div class="top"><p class="src"><a name="v:unprotect" class="def">unprotect</a> :: <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ReleaseKey">ReleaseKey</a> -&gt; m (<a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> ()))</p><div class="doc"><p>Unprotect resource from cleanup actions, this allowes you to send
 resource into another resourcet process and reregister it there.
 It returns an release action that should be run in order to clean
 resource or Nothing in case if resource is already freed.</p><p>Since 0.4.5</p></div></div><div class="top"><p class="src"><a name="v:resourceMask" class="def">resourceMask</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; ((<span class="keyword">forall</span> a. <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a) -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> b) -&gt; m b</p><div class="doc"><p>Perform asynchronous exception masking.</p><p>This is more general then <code>Control.Exception.mask</code>, yet more efficient
 than <code>Control.Exception.Lifted.mask</code>.</p><p>Since 0.3.0</p></div></div><h1 id="g:6">Type class/associated types</h1><div class="top"><p class="src"><span class="keyword">class</span> (<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m, <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m) =&gt; <a name="t:MonadResource" class="def">MonadResource</a> m <span class="keyword">where</span></p><div class="doc"><p>A <code>Monad</code> which allows for safe resource allocation. In theory, any monad
 transformer stack which includes a <code>ResourceT</code> can be an instance of
 <code>MonadResource</code>.</p><p>Note: <code>runResourceT</code> has a requirement for a <code>MonadBaseControl IO m</code> monad,
 which allows control operations to be lifted. A <code>MonadResource</code> does not
 have this requirement. This means that transformers such as <code>ContT</code> can be
 an instance of <code>MonadResource</code>. However, the <code>ContT</code> wrapper will need to be
 unwrapped before calling <code>runResourceT</code>.</p><p>Since 0.3.0</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:liftResourceT" class="def">liftResourceT</a> :: <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> a -&gt; m a</p><div class="doc"><p>Lift a <code>ResourceT IO</code> action into the current <code>Monad</code>.</p><p>Since 0.4.0</p></div></div><div class="subs instances"><p id="control.i:MonadResource" class="caption collapser" onclick="toggleSection('i:MonadResource')">Instances</p><div id="section.i:MonadResource" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-List.html#t:ListT">ListT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../transformers-0.4.2.0/Control-Monad-Trans-Maybe.html#t:MaybeT">MaybeT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../transformers-0.4.2.0/Control-Monad-Trans-Identity.html#t:IdentityT">IdentityT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m, <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-Cont.html#t:ContT">ContT</a> r m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> r m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-State-Strict.html#t:StateT">StateT</a> s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-Except.html#t:ExceptT">ExceptT</a> e m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:Error">Error</a> e, <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-Error.html#t:ErrorT">ErrorT</a> e m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-Writer-Lazy.html#t:WriterT">WriterT</a> w m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-Writer-Strict.html#t:WriterT">WriterT</a> w m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-RWS-Lazy.html#t:RWST">RWST</a> r w s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadResource">MonadResource</a> (<a href="../mtl-2.2.1/Control-Monad-RWS-Strict.html#t:RWST">RWST</a> r w s m)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:MonadResourceBase" class="def">MonadResourceBase</a> m = (<a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m, <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m, <a href="../transformers-0.4.2.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m)</p><div class="doc"><p>A <code>Monad</code> which can be used as a base for a <code>ResourceT</code>.</p><p>A <code>ResourceT</code> has some restrictions on its base monad:</p><ul><li><code>runResourceT</code> requires an instance of <code>MonadBaseControl IO</code>.</li><li><code>MonadResource</code> requires an instance of <code>MonadThrow</code>, <code>MonadIO</code>, and <code>Applicative</code>.</li></ul><p>While any instance of <code>MonadBaseControl IO</code> should be an instance of the
 other classes, this is not guaranteed by the type system (e.g., you may have
 a transformer in your stack with does not implement <code>MonadThrow</code>). Ideally,
 we would like to simply create an alias for the five type classes listed,
 but this is not possible with GHC currently.</p><p>Instead, this typeclass acts as a proxy for the other five. Its only purpose
 is to make your type signatures shorter.</p><p>Note that earlier versions of <code>conduit</code> had a typeclass <code>ResourceIO</code>. This
 fulfills much the same role.</p><p>Since 0.3.2</p></div></div><h2 id="g:7">Low-level</h2><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:InvalidAccess" class="def">InvalidAccess</a></p><div class="doc"><p>Indicates either an error in the library, or misuse of it (e.g., a
 <code>ResourceT</code>'s state is accessed after being released).</p><p>Since 0.3.0</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:InvalidAccess" class="def">InvalidAccess</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:functionName" class="def">functionName</a> :: <a href="../base-4.8.2.0/Data-String.html#t:String">String</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:InvalidAccess" class="caption collapser" onclick="toggleSection('i:InvalidAccess')">Instances</p><div id="section.i:InvalidAccess" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Control-Monad-Trans-Resource.html#t:InvalidAccess">InvalidAccess</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> <a href="Control-Monad-Trans-Resource.html#t:InvalidAccess">InvalidAccess</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:8">Re-exports</h1><div class="top"><p class="src"><span class="keyword">class</span> <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> b m =&gt; <a name="t:MonadBaseControl" class="def">MonadBaseControl</a> b m | m -&gt; b</p><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="../monad-control-1.0.1.0/Control-Monad-Trans-Control.html#v:liftBaseWith">liftBaseWith</a>, <a href="../monad-control-1.0.1.0/Control-Monad-Trans-Control.html#v:restoreM">restoreM</a></p></div><div class="subs instances"><p id="control.i:MonadBaseControl" class="caption collapser" onclick="toggleSection('i:MonadBaseControl')">Instances</p><div id="section.i:MonadBaseControl" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> [] []</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/Data-Functor-Identity.html#t:Identity">Identity</a> <a href="../base-4.8.2.0/Data-Functor-Identity.html#t:Identity">Identity</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/GHC-Conc.html#t:STM">STM</a> <a href="../base-4.8.2.0/GHC-Conc.html#t:STM">STM</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> <a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../transformers-0.4.2.0/Control-Monad-Trans-Maybe.html#t:MaybeT">MaybeT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-List.html#t:ListT">ListT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../transformers-0.4.2.0/Control-Monad-Trans-Identity.html#t:IdentityT">IdentityT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-Writer-Strict.html#t:WriterT">WriterT</a> w m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-Writer-Lazy.html#t:WriterT">WriterT</a> w m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-State-Strict.html#t:StateT">StateT</a> s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> r m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-Except.html#t:ExceptT">ExceptT</a> e m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:Error">Error</a> e, <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-Error.html#t:ErrorT">ErrorT</a> e m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-RWS-Strict.html#t:RWST">RWST</a> r w s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w, <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> b (<a href="../mtl-2.2.1/Control-Monad-RWS-Lazy.html#t:RWST">RWST</a> r w s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> ((-&gt;) r) ((-&gt;) r)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e) (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> (<a href="../base-4.8.2.0/Control-Monad-ST.html#t:ST">ST</a> s) (<a href="../base-4.8.2.0/Control-Monad-ST.html#t:ST">ST</a> s)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadBaseControl">MonadBaseControl</a> (<a href="../base-4.8.2.0/Control-Monad-ST-Lazy.html#t:ST">ST</a> s) (<a href="../base-4.8.2.0/Control-Monad-ST-Lazy.html#t:ST">ST</a> s)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:9">Internal state</h1><div class="doc"><p>A <code>ResourceT</code> internally is a modified <code>ReaderT</code> monad transformer holding
 onto a mutable reference to all of the release actions still remaining to be
 performed. If you are building up a custom application monad, it may be more
 efficient to embed this <code>ReaderT</code> functionality directly in your own monad
 instead of wrapping around <code>ResourceT</code> itself. This section provides you the
 means of doing so.</p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:InternalState" class="def">InternalState</a> = <a href="../base-4.8.2.0/Data-IORef.html#t:IORef">IORef</a> <a href="Control-Monad-Trans-Resource-Internal.html#t:ReleaseMap">ReleaseMap</a></p><div class="doc"><p>The internal state held by a <code>ResourceT</code> transformer.</p><p>Since 0.4.6</p></div></div><div class="top"><p class="src"><a name="v:getInternalState" class="def">getInternalState</a> :: <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a></p><div class="doc"><p>Get the internal state of the current <code>ResourceT</code>.</p><p>Since 0.4.6</p></div></div><div class="top"><p class="src"><a name="v:runInternalState" class="def">runInternalState</a> :: <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a -&gt; <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a> -&gt; m a</p><div class="doc"><p>Unwrap a <code>ResourceT</code> using the given <code>InternalState</code>.</p><p>Since 0.4.6</p></div></div><div class="top"><p class="src"><a name="v:withInternalState" class="def">withInternalState</a> :: (<a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a> -&gt; m a) -&gt; <a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m a</p><div class="doc"><p>Run an action in the underlying monad, providing it the <code>InternalState</code>.</p><p>Since 0.4.6</p></div></div><div class="top"><p class="src"><a name="v:createInternalState" class="def">createInternalState</a> :: <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; m <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a></p><div class="doc"><p>Create a new internal state. This state must be closed with
 <code>closeInternalState</code>. It is your responsibility to ensure exception safety.
 Caveat emptor!</p><p>Since 0.4.9</p></div></div><div class="top"><p class="src"><a name="v:closeInternalState" class="def">closeInternalState</a> :: <a href="../transformers-base-0.4.4/Control-Monad-Base.html#t:MonadBase">MonadBase</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:InternalState">InternalState</a> -&gt; m ()</p><div class="doc"><p>Close an internal state created by <code>createInternalState</code>.</p><p>Since 0.4.9</p></div></div><h1 id="g:10">Backwards compatibility</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ExceptionT" class="def">ExceptionT</a> = <a href="../exceptions-0.8.2.1/Control-Monad-Catch-Pure.html#t:CatchT">CatchT</a></p><div class="doc"><p>For backwards compatibility.</p></div></div><div class="top"><p class="src"><a name="v:runExceptionT" class="def">runExceptionT</a> :: <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> m a -&gt; m (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Control-Exception-Base.html#t:SomeException">SomeException</a> a)</p><div class="doc"><p>For backwards compatibility.</p></div></div><div class="top"><p class="src"><a name="v:runExceptionT_" class="def">runExceptionT_</a> :: <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> m a -&gt; m a</p><div class="doc"><p>Same as <code><a href="Control-Monad-Trans-Resource.html#v:runExceptionT">runExceptionT</a></code>, but immediately <code><a href="../base-4.8.2.0/Control-Exception-Base.html#v:throw">throw</a></code> any exception returned.</p><p>Since 0.3.0</p></div></div><div class="top"><p class="src"><a name="v:runException" class="def">runException</a> :: <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> <a href="../base-4.8.2.0/Data-Functor-Identity.html#t:Identity">Identity</a> a -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Control-Exception-Base.html#t:SomeException">SomeException</a> a</p><div class="doc"><p>Run an <code>ExceptionT Identity</code> stack.</p><p>Since 0.4.2</p></div></div><div class="top"><p class="src"><a name="v:runException_" class="def">runException_</a> :: <a href="Control-Monad-Trans-Resource.html#t:ExceptionT">ExceptionT</a> <a href="../base-4.8.2.0/Data-Functor-Identity.html#t:Identity">Identity</a> a -&gt; a</p><div class="doc"><p>Run an <code>ExceptionT Identity</code> stack, but immediately <code><a href="../base-4.8.2.0/Control-Exception-Base.html#v:throw">throw</a></code> any exception returned.</p><p>Since 0.4.2</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a name="t:MonadThrow" class="def">MonadThrow</a> m <span class="keyword">where</span></p><div class="doc"><p>A class for monads in which exceptions may be thrown.</p><p>Instances should obey the following law:</p><pre>throwM e &gt;&gt; x = throwM e</pre><p>In other words, throwing an exception short-circuits the rest of the monadic
 computation.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:throwM" class="def">throwM</a> :: <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; e -&gt; m a</p><div class="doc"><p>Throw an exception. Note that this throws when this action is run in
 the monad <code>m</code>, not when it is applied. It is a generalization of
 <a href="../base-4.8.2.0/Control-Exception.html">Control.Exception</a>'s <code><a href="../base-4.8.2.0/Control-Exception-Base.html#v:throwIO">throwIO</a></code>.</p><p>Should satisfy the law:</p><pre>throwM e &gt;&gt; f = throwM e</pre></div></div><div class="subs instances"><p id="control.i:MonadThrow" class="caption collapser" onclick="toggleSection('i:MonadThrow')">Instances</p><div id="section.i:MonadThrow" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> []</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> <a href="../template-haskell-2.10.0.0/Language-Haskell-TH-Syntax.html#t:Q">Q</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> <a href="../base-4.8.2.0/GHC-Conc.html#t:STM">STM</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> <a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(~) * e <a href="../base-4.8.2.0/Control-Exception-Base.html#t:SomeException">SomeException</a> =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../exceptions-0.8.2.1/Control-Monad-Catch-Pure.html#t:CatchT">CatchT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-List.html#t:ListT">ListT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../transformers-0.4.2.0/Control-Monad-Trans-Maybe.html#t:MaybeT">MaybeT</a> m)</span></td><td class="doc"><p>Throws exceptions into the base monad.</p></td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../transformers-0.4.2.0/Control-Monad-Trans-Identity.html#t:IdentityT">IdentityT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="Control-Monad-Trans-Resource.html#t:ResourceT">ResourceT</a> m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-Cont.html#t:ContT">ContT</a> r m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> r m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-State-Strict.html#t:StateT">StateT</a> s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-Except.html#t:ExceptT">ExceptT</a> e m)</span></td><td class="doc"><p>Throws exceptions into the base monad.</p></td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:Error">Error</a> e, <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-Error.html#t:ErrorT">ErrorT</a> e m)</span></td><td class="doc"><p>Throws exceptions into the base monad.</p></td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-Writer-Lazy.html#t:WriterT">WriterT</a> w m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-Writer-Strict.html#t:WriterT">WriterT</a> w m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-RWS-Lazy.html#t:RWST">RWST</a> r w s m)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m, <a href="../base-4.8.2.0/Data-Monoid.html#t:Monoid">Monoid</a> w) =&gt; <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> (<a href="../mtl-2.2.1/Control-Monad-RWS-Strict.html#t:RWST">RWST</a> r w s m)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:monadThrow" class="def">monadThrow</a> :: (<a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e, <a href="Control-Monad-Trans-Resource.html#t:MonadThrow">MonadThrow</a> m) =&gt; e -&gt; m a</p><div class="doc"><p>Backwards compatibility</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>